import { getOpenAIAuth, ChatGPTAPI } from "chatgpt";
import type { NextApiRequest, NextApiResponse } from 'next'
export type resData = {
    data: string
}

const handler = async (req: NextApiRequest, res: NextApiResponse<resData>) => {

  const openAIAuth = await getOpenAIAuth({
    email: "sven3270350@gmail.com",
    password: "Asdfg@123#",
  })

  const api = new ChatGPTAPI({ ...openAIAuth, ...{ _sessionToken: "eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0..VuVXSAJZmpGH1tHQ.z1vo8QBZHgF9x5PXR9315mFWRIqdPEKRkuWacE_-arHPq66ft3Miw1EyqMSvLHnYp40ko0zbiIM6OME02fjAJAFSdgkeNMQZu_33ydaNHxV2C3ETGYU7VTeBtHo17Qvbl1o31vYK3SqLbrJD1xwYlnn8LGOz_Gjf3Dmtv20VSTRGn8lOy4XV4pH4_pfKf7pt94JSSlAN4IBLHqydtCAscpAS0XmTV68WmLyKR2v1W306m9Ad61kxB_lXDdcEpsv7v3KDXrBzwk6kuZy5VVpGSfrjS_DLhyDe4Zsf6HSCif_GrNCS_Vy1COAtnOhiWIAC7-4LyqLkk1Txa2WMMW4UmvXnI9B9ejCJ8F2H2TxReXNIdB3x_gHAjRupmuSBy1lrlOKA1kDGw-G5bzm0_9rE1qzeALyxjPntzguq4p0YCKmtondGOwlYi1u0Fx29vJiRc4_HRA44j7ZZOFft1kwbeOjRXwrp8hAeiV_mWtsxoswZXl5SaEgdLtc_vbPhx94JtUs7qLFrKIjLaWxJms65Dv5FmdCNa-nZb6plDrmvLRXn-rYprNx110Gtu4ltlwTn99augGqZ-farpXzVmy4CLTMZ6tkiROHJB3VENhBeYqK4UbNswwbd2PFdXKSW0fJkk7J5XxJLXhGbnyJEkLhUrQZUVRQN5Xo-nlBTdt8hGmoYNOGEqItRZH2MKcL2_sMTc1l-zN-78EzEiIV4kt0LiRLx5eJ6v96RO8XwGa0V1y0hByysphheuSOBChONQyMgM_k-VbOKJ0rDxMrZB63Sar05nsEug503psFAj_prD_BTzXL2UTKOYC8e7l2wJERTypglPmgDbJWuMRKpOGK4TJEA1qvyNnfIP7jnXs9-HpmVU0UZl1wg1o5O2eN-8llo1oZ7gYEfGDZA2jzHPtKq0epTEPUKHmDNu-x8LZ1Q-FV5Ja5NNdcqnx4aKvXg8NgxZbgH49JlMdEk2-JeBZlxMJiGRMUq72vFw9_DI_LS7kb4W1TwmvdnYUX1qtNpUD9MfjamOwKSK57SAuSFqW2BtcoN4tOboZe2fTnPt25P0fIXeIqguHIH7cHQf1pK60_j-xoqIlN1dy9pjeys82t1XBMS8B4PK7BrcTLOCmNComh47jVZDG_lO_vNgKoE7kaf2ZqIPauLWGTFFey7Bh11UAiNc5n5bSb3B1n2RGpEqCNnxtKBszOJqYOtMy0mQxP9lb0S_ny1Fr9WAbA0aSYZVDFgKluHkfmrekTIriKzogqiF0qq-7xIb8yF9mPEtyBZSVU5_QxOQ58mJiRQ5swqApf6jp9eTa_4ENoGLm3QXFB-PpQ6pOQf6Wt-FeX8M_HghRI1H4jnP3PP5mZq1GBjosBPYaEfuQxt0TqIjjxKyRZ3WeW2eb690D8EZx3tiTcTapkv27vT19WhEP_e4fzC39MFwOy78pYX8Of6uoFP9oAUirRNa7ZXtbjTZyU9ipJKY4MXftNYa4U23tagvJulMU-aT49X9aW8Z8s5A7HmLyiKMHsq3k3-9xy8Tn0_xW1y9L4RQ2GUQ_M1aqWD2MGSQIPnCdBCHEHQe7rtSJzt2-oPWOx8z_FgiOWiu4Rep04GcHHgp8obRmZGBNmdZR9Qwjhjub9sCNHEG1Gn-n8byGBL-inZ5qngCsbvWQHLII-aAhxrTz3iQLPjD5h9J1SF_0Z8DGzLWKhZgpOAwWFkRgV2QzYxGcf1vCc6Qe9wYPZ28UaMA1h7p-UDvi7N023UwIYB5aJ-rvgtrOuQuHCkmqK8SFR2YzQxJGcgvOWunE46G-W1MwTHLUWQUHloa8xf8cqeRUkHLMqVBvDEjuPp8UnOIPPQn5s5pledCzGYTDNOF9JRpnyUd0IMv29E3ZifKnh6YN0GaYALDPPbSzwDkcj-mjVs0MEXmTqOfzvHM1qbpFCu7f9eyklNmbxojfRNNlPsjSEimRb7akqIWO5Azt7RZ6XZye3UAnd9pNbn2l1v47DqZcH-0r6DAKxTsMotuN6j5AxW9nGlzpe3Sj19---eybxWIun1WyZIQwrd9rSyzord4k_V7GQVjxbXdXgY87G3I58H3OxnqI1s-wY1SEa0BsTA1kKinwzPu2ZvAYnlmtVnCIMQounI132ibTgAOqL81Em2UxXBbsqHYLK9kTirSiRkT9CnWbcnxk8BcF3jiHNb5TUMBLJfFb8YxFJG7JIJ3Jp2bWf75su__PY7q7Qxo4ss2RWFXkU6EaboErqAyOABypO7AdqiO9NXs0INJ3P5Yn4Y7Fl6gxCqa1AkpV2IOn021bgoT5p1f3ShGj214YARMJb2sVB7TCmwOzo9V7TV6Bhmob9yLvynzy25ChsgdNPXWXt-x3swf8Kmroguowd5.zZZ7jJltiV_VdXhFx-c37A" } })
  await api.initSession()

  const result = await api.sendMessage('Write a python version of bubble sort.')

  // result.response is a markdown-formatted string
  console.log("~~~~~#~~~~~~", result.response)
}

export default handler